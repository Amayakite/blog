const n=JSON.parse('{"key":"v-3b4739e2","path":"/JavaLang/SpringCloud/14-1-Seata%E9%83%A8%E7%BD%B2%E5%85%A8%E6%B5%81%E7%A8%8B.html","title":"14-1-Seata部署全流程","lang":"zh-CN","frontmatter":{"title":"14-1-Seata部署全流程","date":"2022-01-14T12:13:30.000Z","category":"分布式-微服务","tag":["微服务","Spring Cloud Alibaba","Seata"],"description":"先说总结 除非万不得已，不然千万别用本地配置..非常多的BUG 数据库准备（服务端） create database seata; use seata; CREATE TABLE IF NOT EXISTS `global_table` ( `xid` VARCHAR(128) NOT NULL, `transaction_id` BIGINT, `status` TINYINT NOT NULL, `application_id` VARCHAR(32), `transaction_service_group` VARCHAR(32), `transaction_name` VARCHAR(128), `timeout` INT, `begin_time` BIGINT, `application_data` VARCHAR(2000), `gmt_create` DATETIME, `gmt_modified` DATETIME, PRIMARY KEY (`xid`), KEY `idx_gmt_modified_status` (`gmt_modified`, `status`), KEY `idx_transaction_id` (`transaction_id`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8; -- the table to store BranchSession data CREATE TABLE IF NOT EXISTS `branch_table` ( `branch_id` BIGINT NOT NULL, `xid` VARCHAR(128) NOT NULL, `transaction_id` BIGINT, `resource_group_id` VARCHAR(32), `resource_id` VARCHAR(256), `branch_type` VARCHAR(8), `status` TINYINT, `client_id` VARCHAR(64), `application_data` VARCHAR(2000), `gmt_create` DATETIME(6), `gmt_modified` DATETIME(6), PRIMARY KEY (`branch_id`), KEY `idx_xid` (`xid`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8; -- the table to store lock data CREATE TABLE IF NOT EXISTS `lock_table` ( `row_key` VARCHAR(128) NOT NULL, `xid` VARCHAR(128), `transaction_id` BIGINT, `branch_id` BIGINT NOT NULL, `resource_id` VARCHAR(256), `table_name` VARCHAR(32), `pk` VARCHAR(36), `status` TINYINT NOT NULL DEFAULT \'0\' COMMENT \'0:locked ,1:rollbacking\', `gmt_create` DATETIME, `gmt_modified` DATETIME, PRIMARY KEY (`row_key`), KEY `idx_status` (`status`), KEY `idx_branch_id` (`branch_id`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8; CREATE TABLE IF NOT EXISTS `distributed_lock` ( `lock_key` CHAR(20) NOT NULL, `lock_value` VARCHAR(20) NOT NULL, `expire` BIGINT, primary key (`lock_key`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4; INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (\'AsyncCommitting\', \' \', 0); INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (\'RetryCommitting\', \' \', 0); INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (\'RetryRollbacking\', \' \', 0); INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (\'TxTimeoutCheck\', \' \', 0);","head":[["meta",{"property":"og:url","content":"http://www.amayakite.github.io/JavaLang/SpringCloud/14-1-Seata%E9%83%A8%E7%BD%B2%E5%85%A8%E6%B5%81%E7%A8%8B.html"}],["meta",{"property":"og:site_name","content":"Amayakite Blogs"}],["meta",{"property":"og:title","content":"14-1-Seata部署全流程"}],["meta",{"property":"og:description","content":"先说总结 除非万不得已，不然千万别用本地配置..非常多的BUG 数据库准备（服务端） create database seata; use seata; CREATE TABLE IF NOT EXISTS `global_table` ( `xid` VARCHAR(128) NOT NULL, `transaction_id` BIGINT, `status` TINYINT NOT NULL, `application_id` VARCHAR(32), `transaction_service_group` VARCHAR(32), `transaction_name` VARCHAR(128), `timeout` INT, `begin_time` BIGINT, `application_data` VARCHAR(2000), `gmt_create` DATETIME, `gmt_modified` DATETIME, PRIMARY KEY (`xid`), KEY `idx_gmt_modified_status` (`gmt_modified`, `status`), KEY `idx_transaction_id` (`transaction_id`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8; -- the table to store BranchSession data CREATE TABLE IF NOT EXISTS `branch_table` ( `branch_id` BIGINT NOT NULL, `xid` VARCHAR(128) NOT NULL, `transaction_id` BIGINT, `resource_group_id` VARCHAR(32), `resource_id` VARCHAR(256), `branch_type` VARCHAR(8), `status` TINYINT, `client_id` VARCHAR(64), `application_data` VARCHAR(2000), `gmt_create` DATETIME(6), `gmt_modified` DATETIME(6), PRIMARY KEY (`branch_id`), KEY `idx_xid` (`xid`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8; -- the table to store lock data CREATE TABLE IF NOT EXISTS `lock_table` ( `row_key` VARCHAR(128) NOT NULL, `xid` VARCHAR(128), `transaction_id` BIGINT, `branch_id` BIGINT NOT NULL, `resource_id` VARCHAR(256), `table_name` VARCHAR(32), `pk` VARCHAR(36), `status` TINYINT NOT NULL DEFAULT \'0\' COMMENT \'0:locked ,1:rollbacking\', `gmt_create` DATETIME, `gmt_modified` DATETIME, PRIMARY KEY (`row_key`), KEY `idx_status` (`status`), KEY `idx_branch_id` (`branch_id`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8; CREATE TABLE IF NOT EXISTS `distributed_lock` ( `lock_key` CHAR(20) NOT NULL, `lock_value` VARCHAR(20) NOT NULL, `expire` BIGINT, primary key (`lock_key`) ) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4; INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (\'AsyncCommitting\', \' \', 0); INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (\'RetryCommitting\', \' \', 0); INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (\'RetryRollbacking\', \' \', 0); INSERT INTO `distributed_lock` (lock_key, lock_value, expire) VALUES (\'TxTimeoutCheck\', \' \', 0);"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-06-17T15:14:40.000Z"}],["meta",{"property":"article:author","content":"Amayakite"}],["meta",{"property":"article:tag","content":"微服务"}],["meta",{"property":"article:tag","content":"Spring Cloud Alibaba"}],["meta",{"property":"article:tag","content":"Seata"}],["meta",{"property":"article:published_time","content":"2022-01-14T12:13:30.000Z"}],["meta",{"property":"article:modified_time","content":"2023-06-17T15:14:40.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"14-1-Seata部署全流程\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-01-14T12:13:30.000Z\\",\\"dateModified\\":\\"2023-06-17T15:14:40.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Amayakite\\",\\"url\\":\\"https://github.com/Amayakite\\"}]}"]]},"headers":[{"level":2,"title":"先说总结","slug":"先说总结","link":"#先说总结","children":[]},{"level":2,"title":"数据库准备（服务端）","slug":"数据库准备-服务端","link":"#数据库准备-服务端","children":[]},{"level":2,"title":"服务端搭建(Server)-本地","slug":"服务端搭建-server-本地","link":"#服务端搭建-server-本地","children":[{"level":3,"title":"registry.conf","slug":"registry-conf","link":"#registry-conf","children":[]},{"level":3,"title":"file.conf","slug":"file-conf","link":"#file-conf","children":[]}]},{"level":2,"title":"服务端搭建(Server)-Nacos","slug":"服务端搭建-server-nacos","link":"#服务端搭建-server-nacos","children":[{"level":3,"title":"registry.conf","slug":"registry-conf-1","link":"#registry-conf-1","children":[]},{"level":3,"title":"文件上传到Nacos的脚本","slug":"文件上传到nacos的脚本","link":"#文件上传到nacos的脚本","children":[]},{"level":3,"title":"上传的内容准备","slug":"上传的内容准备","link":"#上传的内容准备","children":[]}]},{"level":2,"title":"数据库准备（客户端）","slug":"数据库准备-客户端","link":"#数据库准备-客户端","children":[]},{"level":2,"title":"客户端","slug":"客户端","link":"#客户端","children":[{"level":3,"title":"依赖","slug":"依赖","link":"#依赖","children":[]},{"level":3,"title":"配置文件","slug":"配置文件","link":"#配置文件","children":[]},{"level":3,"title":"主启动类关闭自动加载数据库","slug":"主启动类关闭自动加载数据库","link":"#主启动类关闭自动加载数据库","children":[]},{"level":3,"title":"自定义数据源","slug":"自定义数据源","link":"#自定义数据源","children":[]},{"level":3,"title":"使用","slug":"使用","link":"#使用","children":[]}]}],"git":{"createdTime":1687006308000,"updatedTime":1687014880000,"contributors":[{"name":"Amayakite","email":"amayakite@qq.com","commits":2}]},"readingTime":{"minutes":10.16,"words":3048},"filePathRelative":"JavaLang/SpringCloud/14-1-Seata部署全流程.md","localizedDate":"2022年1月14日","excerpt":"<h2> 先说总结</h2>\\n<p>除非万不得已，不然千万别用本地配置..非常多的BUG</p>\\n<h2> 数据库准备（服务端）</h2>\\n<div class=\\"language-sql line-numbers-mode\\" data-ext=\\"sql\\"><pre class=\\"language-sql\\"><code><span class=\\"token keyword\\">create</span> <span class=\\"token keyword\\">database</span> seata<span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">use</span> seata<span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">CREATE</span> <span class=\\"token keyword\\">TABLE</span> <span class=\\"token keyword\\">IF</span> <span class=\\"token operator\\">NOT</span> <span class=\\"token keyword\\">EXISTS</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>global_table<span class=\\"token punctuation\\">`</span></span>\\n<span class=\\"token punctuation\\">(</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>xid<span class=\\"token punctuation\\">`</span></span>                       <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">128</span><span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">NOT</span> <span class=\\"token boolean\\">NULL</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>transaction_id<span class=\\"token punctuation\\">`</span></span>            <span class=\\"token keyword\\">BIGINT</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>status<span class=\\"token punctuation\\">`</span></span>                    <span class=\\"token keyword\\">TINYINT</span>      <span class=\\"token operator\\">NOT</span> <span class=\\"token boolean\\">NULL</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>application_id<span class=\\"token punctuation\\">`</span></span>            <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">32</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>transaction_service_group<span class=\\"token punctuation\\">`</span></span> <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">32</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>transaction_name<span class=\\"token punctuation\\">`</span></span>          <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">128</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>timeout<span class=\\"token punctuation\\">`</span></span>                   <span class=\\"token keyword\\">INT</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>begin_time<span class=\\"token punctuation\\">`</span></span>                <span class=\\"token keyword\\">BIGINT</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>application_data<span class=\\"token punctuation\\">`</span></span>          <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">2000</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>gmt_create<span class=\\"token punctuation\\">`</span></span>                <span class=\\"token keyword\\">DATETIME</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>gmt_modified<span class=\\"token punctuation\\">`</span></span>              <span class=\\"token keyword\\">DATETIME</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token keyword\\">PRIMARY</span> <span class=\\"token keyword\\">KEY</span> <span class=\\"token punctuation\\">(</span><span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>xid<span class=\\"token punctuation\\">`</span></span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token keyword\\">KEY</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>idx_gmt_modified_status<span class=\\"token punctuation\\">`</span></span> <span class=\\"token punctuation\\">(</span><span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>gmt_modified<span class=\\"token punctuation\\">`</span></span><span class=\\"token punctuation\\">,</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>status<span class=\\"token punctuation\\">`</span></span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token keyword\\">KEY</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>idx_transaction_id<span class=\\"token punctuation\\">`</span></span> <span class=\\"token punctuation\\">(</span><span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>transaction_id<span class=\\"token punctuation\\">`</span></span><span class=\\"token punctuation\\">)</span>\\n<span class=\\"token punctuation\\">)</span> <span class=\\"token keyword\\">ENGINE</span> <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">InnoDB</span>\\n  <span class=\\"token keyword\\">DEFAULT</span> <span class=\\"token keyword\\">CHARSET</span> <span class=\\"token operator\\">=</span> utf8<span class=\\"token punctuation\\">;</span>\\n\\n<span class=\\"token comment\\">-- the table to store BranchSession data</span>\\n<span class=\\"token keyword\\">CREATE</span> <span class=\\"token keyword\\">TABLE</span> <span class=\\"token keyword\\">IF</span> <span class=\\"token operator\\">NOT</span> <span class=\\"token keyword\\">EXISTS</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>branch_table<span class=\\"token punctuation\\">`</span></span>\\n<span class=\\"token punctuation\\">(</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>branch_id<span class=\\"token punctuation\\">`</span></span>         <span class=\\"token keyword\\">BIGINT</span>       <span class=\\"token operator\\">NOT</span> <span class=\\"token boolean\\">NULL</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>xid<span class=\\"token punctuation\\">`</span></span>               <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">128</span><span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">NOT</span> <span class=\\"token boolean\\">NULL</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>transaction_id<span class=\\"token punctuation\\">`</span></span>    <span class=\\"token keyword\\">BIGINT</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>resource_group_id<span class=\\"token punctuation\\">`</span></span> <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">32</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>resource_id<span class=\\"token punctuation\\">`</span></span>       <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">256</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>branch_type<span class=\\"token punctuation\\">`</span></span>       <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">8</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>status<span class=\\"token punctuation\\">`</span></span>            <span class=\\"token keyword\\">TINYINT</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>client_id<span class=\\"token punctuation\\">`</span></span>         <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">64</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>application_data<span class=\\"token punctuation\\">`</span></span>  <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">2000</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>gmt_create<span class=\\"token punctuation\\">`</span></span>        <span class=\\"token keyword\\">DATETIME</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">6</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>gmt_modified<span class=\\"token punctuation\\">`</span></span>      <span class=\\"token keyword\\">DATETIME</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">6</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token keyword\\">PRIMARY</span> <span class=\\"token keyword\\">KEY</span> <span class=\\"token punctuation\\">(</span><span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>branch_id<span class=\\"token punctuation\\">`</span></span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token keyword\\">KEY</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>idx_xid<span class=\\"token punctuation\\">`</span></span> <span class=\\"token punctuation\\">(</span><span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>xid<span class=\\"token punctuation\\">`</span></span><span class=\\"token punctuation\\">)</span>\\n<span class=\\"token punctuation\\">)</span> <span class=\\"token keyword\\">ENGINE</span> <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">InnoDB</span>\\n  <span class=\\"token keyword\\">DEFAULT</span> <span class=\\"token keyword\\">CHARSET</span> <span class=\\"token operator\\">=</span> utf8<span class=\\"token punctuation\\">;</span>\\n\\n<span class=\\"token comment\\">-- the table to store lock data</span>\\n<span class=\\"token keyword\\">CREATE</span> <span class=\\"token keyword\\">TABLE</span> <span class=\\"token keyword\\">IF</span> <span class=\\"token operator\\">NOT</span> <span class=\\"token keyword\\">EXISTS</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>lock_table<span class=\\"token punctuation\\">`</span></span>\\n<span class=\\"token punctuation\\">(</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>row_key<span class=\\"token punctuation\\">`</span></span>        <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">128</span><span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">NOT</span> <span class=\\"token boolean\\">NULL</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>xid<span class=\\"token punctuation\\">`</span></span>            <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">128</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>transaction_id<span class=\\"token punctuation\\">`</span></span> <span class=\\"token keyword\\">BIGINT</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>branch_id<span class=\\"token punctuation\\">`</span></span>      <span class=\\"token keyword\\">BIGINT</span>       <span class=\\"token operator\\">NOT</span> <span class=\\"token boolean\\">NULL</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>resource_id<span class=\\"token punctuation\\">`</span></span>    <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">256</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>table_name<span class=\\"token punctuation\\">`</span></span>     <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">32</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>pk<span class=\\"token punctuation\\">`</span></span>             <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">36</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>status<span class=\\"token punctuation\\">`</span></span>         <span class=\\"token keyword\\">TINYINT</span>      <span class=\\"token operator\\">NOT</span> <span class=\\"token boolean\\">NULL</span> <span class=\\"token keyword\\">DEFAULT</span> <span class=\\"token string\\">\'0\'</span> <span class=\\"token keyword\\">COMMENT</span> <span class=\\"token string\\">\'0:locked ,1:rollbacking\'</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>gmt_create<span class=\\"token punctuation\\">`</span></span>     <span class=\\"token keyword\\">DATETIME</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>gmt_modified<span class=\\"token punctuation\\">`</span></span>   <span class=\\"token keyword\\">DATETIME</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token keyword\\">PRIMARY</span> <span class=\\"token keyword\\">KEY</span> <span class=\\"token punctuation\\">(</span><span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>row_key<span class=\\"token punctuation\\">`</span></span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token keyword\\">KEY</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>idx_status<span class=\\"token punctuation\\">`</span></span> <span class=\\"token punctuation\\">(</span><span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>status<span class=\\"token punctuation\\">`</span></span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token keyword\\">KEY</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>idx_branch_id<span class=\\"token punctuation\\">`</span></span> <span class=\\"token punctuation\\">(</span><span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>branch_id<span class=\\"token punctuation\\">`</span></span><span class=\\"token punctuation\\">)</span>\\n<span class=\\"token punctuation\\">)</span> <span class=\\"token keyword\\">ENGINE</span> <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">InnoDB</span>\\n  <span class=\\"token keyword\\">DEFAULT</span> <span class=\\"token keyword\\">CHARSET</span> <span class=\\"token operator\\">=</span> utf8<span class=\\"token punctuation\\">;</span>\\n\\n<span class=\\"token keyword\\">CREATE</span> <span class=\\"token keyword\\">TABLE</span> <span class=\\"token keyword\\">IF</span> <span class=\\"token operator\\">NOT</span> <span class=\\"token keyword\\">EXISTS</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>distributed_lock<span class=\\"token punctuation\\">`</span></span>\\n<span class=\\"token punctuation\\">(</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>lock_key<span class=\\"token punctuation\\">`</span></span>       <span class=\\"token keyword\\">CHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">20</span><span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">NOT</span> <span class=\\"token boolean\\">NULL</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>lock_value<span class=\\"token punctuation\\">`</span></span>     <span class=\\"token keyword\\">VARCHAR</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">20</span><span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">NOT</span> <span class=\\"token boolean\\">NULL</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>expire<span class=\\"token punctuation\\">`</span></span>         <span class=\\"token keyword\\">BIGINT</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token keyword\\">primary</span> <span class=\\"token keyword\\">key</span> <span class=\\"token punctuation\\">(</span><span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>lock_key<span class=\\"token punctuation\\">`</span></span><span class=\\"token punctuation\\">)</span>\\n<span class=\\"token punctuation\\">)</span> <span class=\\"token keyword\\">ENGINE</span> <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">InnoDB</span>\\n  <span class=\\"token keyword\\">DEFAULT</span> <span class=\\"token keyword\\">CHARSET</span> <span class=\\"token operator\\">=</span> utf8mb4<span class=\\"token punctuation\\">;</span>\\n\\n<span class=\\"token keyword\\">INSERT</span> <span class=\\"token keyword\\">INTO</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>distributed_lock<span class=\\"token punctuation\\">`</span></span> <span class=\\"token punctuation\\">(</span>lock_key<span class=\\"token punctuation\\">,</span> lock_value<span class=\\"token punctuation\\">,</span> expire<span class=\\"token punctuation\\">)</span> <span class=\\"token keyword\\">VALUES</span> <span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\'AsyncCommitting\'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">\' \'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token number\\">0</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">INSERT</span> <span class=\\"token keyword\\">INTO</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>distributed_lock<span class=\\"token punctuation\\">`</span></span> <span class=\\"token punctuation\\">(</span>lock_key<span class=\\"token punctuation\\">,</span> lock_value<span class=\\"token punctuation\\">,</span> expire<span class=\\"token punctuation\\">)</span> <span class=\\"token keyword\\">VALUES</span> <span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\'RetryCommitting\'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">\' \'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token number\\">0</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">INSERT</span> <span class=\\"token keyword\\">INTO</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>distributed_lock<span class=\\"token punctuation\\">`</span></span> <span class=\\"token punctuation\\">(</span>lock_key<span class=\\"token punctuation\\">,</span> lock_value<span class=\\"token punctuation\\">,</span> expire<span class=\\"token punctuation\\">)</span> <span class=\\"token keyword\\">VALUES</span> <span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\'RetryRollbacking\'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">\' \'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token number\\">0</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">INSERT</span> <span class=\\"token keyword\\">INTO</span> <span class=\\"token identifier\\"><span class=\\"token punctuation\\">`</span>distributed_lock<span class=\\"token punctuation\\">`</span></span> <span class=\\"token punctuation\\">(</span>lock_key<span class=\\"token punctuation\\">,</span> lock_value<span class=\\"token punctuation\\">,</span> expire<span class=\\"token punctuation\\">)</span> <span class=\\"token keyword\\">VALUES</span> <span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\'TxTimeoutCheck\'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">\' \'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token number\\">0</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{n as data};
